# předmluva

Celý tento projekt byl vytvořen jako semestrální projekt pro předmět BI-PA2 na ČVUT FIT.
Z povahy projektu a zadání je všem studentům této školy v rámci svého BI-PA2 projektu zakázáno použít jakékoliv zdrojové soubory, části kódu či textové soubory z tohoto repozitáře. Věřte, že to nedělám kvůli sobě, ale kvůli vám.
Pokud si kdokoliv z vás bude chtít vzít inspiraci z tohoto díla, je to možné na základě konceptů či myšlenky.
Nakonec ale musím říct, že vaše jednání a z toho vyvozené náslekdy nebudou problémem mým, ale pouze vaším.

# introduction

This is my semestral project in BI-PA2 subject at CTU Faculty of Information Technology.
I do not suppose that anyone reading this studies at CTU FIT but just for sure.
It is forbidden to use this code as a part of your BI-PA2 semestral work. All you can do is to be inspired by ideas on conception level.
But I have to admit that your doing and the problems connected with it are only yours, not mine.

# použití

Pokud nespadáte do předchozí kategorie a chtěli byste toto dílo jakkoliv použít, máte mé svolení. Bylo by hezké, kdybyste mne uvedli jako autora či dali odkaz na můj GitHub při následovném šíření. Ale nemůžu nikoho nutit.

# usage

You are allowed to use this code for all kind of actions, only if you are not currently studying CTU FIT and you dont want to use it for your BI-PA2 semestral project.
It would be nice to mention me in your source codes or to mention my GitHub once you are sharing your work. But who am I to force you, right?

# TDEninge (tower defense engine)

Jako téma své semestrální práce jsem si vybral tower defense hru.

# použité knihy a nástroje

Hra používá knihovnu `<termios.h>`, která je dostupná na Linuxových distribucích. Proto použijte Linux či WSL pro spuštění na Windows. Používám také nástroj `doxygen` pro generování dokumentace (ten není ke spuštění hry třeba).

# used libraries and utilities

The game uses `<termios.h>` library available only (as far as I know) on Linux distributions. Therefore, you have to use Linux or WSL for Windows compatibility. The documentation is generated by `doxygen` utility (but it isn't required for starting the game binary).

# Makefile

- `make all`
  - zkompiluje, vygeneruje dokumentaci
- `make compile`
  - zkompiluje
- `make run`
  - spustí program
- `make clean`
  - smaže všechny vygenerované soubory
- `make doc`
  - vygeneruje dokumentaci pomocí nástroje doxygen

# Gameplay

Hra obsahuje nekolik obrazovek (řekněme tedy instancí).

## Main menu

Hlavní menu obsahuje několik možností: 
 - vstup do nové hry (NEW GAME)
 - vstup do načtených her (LOAD GAME)
 - vstup do katalogu věží a nepřátel (GAME INFO)
 - ukončení samotné hry. (EXIT)

### Ovládání:
 - W - nahoru
 - S - dolů
 - E - potvrzení
 - Q - zpět (tady ukončuje hru)

## New game

V seznamu hráč nalezne výběr z dostupných map, které si může zahrát.

### Ovládání:
 - W - nahoru
 - S - dolů
 - E - potvrzení
 - Q - zpět (tady ukončuje hru)

## Load game

V seznamu hráč nalezne výběr uložených pozic k hraní. Je možné také uložené pozice mazat.

### Ovládání:
 - W - nahoru
 - S - dolů
 - E - potvrzení
 - Q - zpět (tady ukončuje hru)
 - R - maže uloženou pozici

## GAME INFO

Vypíše seznam věží a nepřátel, včetně jejich vzhledu, poškození, příběhu a všeho možného.

### Ovládání:
 - Q - zpět

## Hra

Samotná hra se dělí na 'buy' fázi a na 'game' fázi.

## Hra - buy fáze

V 'buy' fázi se hráč pohybuje po mapě, nakupuje věže a je možné hru ukončit.

### Ovládání:
 - W - nahoru
 - S - dolů
 - A - vlevo
 - D - vpravo
 - Q - zpět (otevře menu pro uložení)
 - E - otevře nabídku věží k nakoupení
 - F - spustí vlnu nepřátel (hra se přepne do 'game' fáze)

 - `cheat` - v obrazovce pohybu kurzoru je možné stisknout klávesu 'M', která hráči dá nějakou tu zlatku.

## Hra - game fáze

V 'game' probíhá samotná hra, veškerá interakce od hráče je vypnuta.

---

## VÝHRA / PROHRA

### Výhra: hráč vyhraje po zabití x nepřátel, zobrazeno na obrazovce

### Prohra: hráč prohraje, když jeho životy klesnou na nebo pod hranici 0 životů

---

# Věže:

Útok je implementován ve dvou verzích:
 - area of effect
 - cross

```
CROSS:              AOE:

..x..               xxxxx
..x..               xxxxx
xxAxx               xxAxx
..x..               xxxxx
..x..               xxxxx

Vzdálenost (range) útoku může být modifikována.
```

# Nepřátelé:

Nepřátelé se mohou pohybovat a přes A* pathfidner se přibližuje ke konci. Když dojde do konce, tak udělí poškození hráči. V případě smrti přičte hráči skóre a peníze. Každý nepřítel má odměnu za zabití, poškození, životy, popis a příběh.

# Tvorba map

Hráč si může snadno vytvořit mapu. Stačí mu k tomu obdelníková herní plocha a její velikost. Hrací plocha musí obsahovat start 'S', konec 'E', zdí '#' a prázdné místo ' '. Pokud se hráč pokusí o něco nekalého (neprůchozí mapa, chybějící konec a start, nevalidní herní plán), program to detekuje a odmítne takovou mapu načíst. Start a konec musí být průchozí a taktéž ne hned vedle sebe.

Příklad ve validním formátu:
```
4 5
####
#  S
#  #
E  #
####
```

Jméno mapy může obsahovat pouze tyto znaky 'A-Za-z0-9_' a mělo by být 20 znaků dlouhé (vhodné je doplnění koncovky .txt). Poté musí přidat uloženou pozici do složky src a do save_indexer.txt složky zadat následující:

```
my_map.txt|my_awesome_map
```

Přesně v tomto formátu (první cesta k mapě, druhé jméno mapy).

# Tvorba uložených pozic

Hráč si také může ručně (pokud se nespokojí s uložením přímo ve hře) vytvořit svůj vlastní save. Save může být ve formátu:

```
20 20
100 100 100

TOWER
1
20 30

TOWER
2
30 30
```
 - 20 20 - validační velikost mapy - povinné
 - 100 100 100 - HP skóre peníze - povinné

 - TOWER
 - 2 - typ věže
 - 30 30 - souřadnice

Následně do save_indexeru uloží toto:

```
my_map.txt|my_save.txt|my_save|12.10.2020 4:56:12
```

- cesta k mapě (bez předpony save/, hra si sama doplní)
- cesta k uložené pozici
- jméno
- čas

`název souboru uložené pozice a samotné uložené pozice nemusí být stejné, je to jen konvence programu, který tak uložené pozice vytváří`

# Polymorfismus

- `CRenderer` - tato třída je abstraktní třídou pro další třídy, které vypisují do konzole obsah hry přes přetíženou metodu Render v CGameInstance. Odvozené třídy: `CMainMenu`, `CGameRenderer`, `CGameInfo`, `CNewGame` a `CLoadGame`
- `CField` - tato třída je abstraktní třídou pro další třídy, které jsou uloženy v jedné mapě reprezentující herní plochu. U nich je přetížena metoda Print, která je využívána pro výpis do konzole. Odvozené třídy: `CEmpty`, `CEntity` (z ní poté `CEnemy` a `CTower`)
- `CEntity` - tato třída je abstraktní třídou pro další třídy `CEnemy` a `CTower`. U nich je přetížena a polymorfně využita metoda Action, která vrací seznam akcí a provádí akce v entitách samotných.
- `CToken` - tato třída je abstraktní pro třídy `CToenEnemy` a `CTokenTower`. U nich se přetěžují metody ConsolePrintShort a ConsolePrintLong.

Polymorfismus tedy pokládám za splněný.